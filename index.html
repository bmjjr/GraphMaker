<!DOCTYPE html>
<html>
<head>
<style>
body {
    background-color: #333;
    color: #fff;
    font: 300 100.1% "Helvetica Neue", Helvetica, "Arial Unicode MS", Arial, sans-serif;
    }
</style>
<link rel="stylesheet" type="text/css" href="css/joint.css" />
<link rel="stylesheet" type="text/css" href="css/style.css" />
<link rel="stylesheet" type="text/css" href="css/mycss.css" />
<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/joint.js"></script>
<script type="text/javascript" src="js/joint.shapes.devs.min.js"></script>
<script type="text/javascript" src="js/FileSaver.js"></script>
<script type="text/javascript" src="js/validate.js"></script>
<script type="text/javascript" src="js/elements.js"></script>
<script type="text/javascript" src="js/buttons.js"></script>

<script>
var linkkind=1;
var cellkind = 1;
var saved = true;
</script>

</head>
<body>

<div id="wrapper">
<div id="div1">
Add Cells (click on color cell) 
<form name="NewCell" action="javascript:onCreateButtonClick();" onsubmit="return validateCell()" method="post">
Name: <input type="text" name="fname">
URL: <input type="text" name="flink" value="" >
<input type="checkbox" name="stylecell" value="dashed" id="iscelldashed">dashed
</form>
<br>
<svg width="110" height="40" xmlns="http://www.w3.org/2000/svg">
<g>
  <rect x="0" y ="0" class="btn" width="100" height="40" style="fill: #333;stroke-width:3;stroke: #7cbf00" onclick="if (validateCell()) {cellkind = 1; document.NewCell.submit();}"></rect>
  <text x="25" y="25"  fill="#fff" onclick="if (validateCell()) { cellkind = 1; document.NewCell.submit();}"> Create </text>
</g>
</svg>

<svg width="100" height="40" xmlns="http://www.w3.org/2000/svg">
<g>
  <rect x="0" y ="0" class="btn" width="100" height="40" style="fill: #333;stroke-width:3;stroke: #bf0000" onclick="if (validateCell()) {cellkind = 2; document.NewCell.submit();}"></rect>
  <text x="25" y="25"  fill="#fff" onclick="if (validateCell()) {cellkind = 2; document.NewCell.submit();}"> Create </text>
</g>
</svg>

<svg width="100" height="40" xmlns="http://www.w3.org/2000/svg">
<g>
  <rect x="0" y ="0" class="btn" width="100" height="40" style="fill: #333;stroke-width:3;stroke: #6495ED" onclick="if (validateCell()) {cellkind = 3; document.NewCell.submit();}"></rect>
  <text x="25" y="25"  fill="#fff" onclick="if (validateCell()) {cellkind = 3; document.NewCell.submit();}"> Create </text>
</g>
</svg>
</div>
<div id = "div2">

Add Links (click on arrows)
<form name="NewLink" action="javascript:onCreateLinkClick();" method="post">
Name: <input type="text" name="Lname">
<input type="checkbox" name="style" value="dashed" id="isdashed">dashed
</form>

<br>

<svg width="110" height="40" xmlns="http://www.w3.org/2000/svg">
<defs>
    <marker id="markerArrow1" markerWidth="13" markerHeight="13" refX="2" refY="3"
           orient="auto">
        <path  d="M6,0 L2,3 L6,6 L6,0" style="fill: #bf5600;" />
    </marker>

        <marker id="markerArrow" markerWidth="13" markerHeight="13" refX="2" refY="3"
           orient="auto">
        <path  d="M2,0 L6,3 L2,6 L2,0" style="fill: #bf5600;" />
    </marker>
</defs>
  <g>
    <rect x="0" y ="0" class="btn" width="100" height="40" style="fill: #333;stroke-width:0;stroke: #333" onclick="linkkind = 1; document.NewLink.submit();"></rect>
    <line x1="10" y1="25" x2="80" y2="25" style="stroke:#bf5600;stroke-width:3;marker-end: url(#markerArrow);" />
  </g>
</svg>


<svg width="110" height="40" xmlns="http://www.w3.org/2000/svg">
  <g>
    <rect x="0" y ="0" class="btn" width="100" height="40" style="fill: #333;stroke-width:0;stroke: #333" onclick="linkkind =2 ;document.NewLink.submit();"></rect>
    <line x1="10" y1="25" x2="80" y2="25" style="stroke:#bf5600;stroke-width:3 ;marker-start: url(#markerArrow1); marker-end: url(#markerArrow); " />
  </g>
</svg>

<svg width="110" height="40" xmlns="http://www.w3.org/2000/svg">
  <g>
    <rect x="0" y ="0" class="btn" width="100" height="40" style="fill: #333;stroke-width:0;stroke: #333" onclick="linkkind =3 ;document.NewLink.submit();"></rect>
    <line x1="10" y1="25" x2="80" y2="25" style="stroke:#bf5600;stroke-width:3 " />
  </g>
</svg>


</div>
<div id="div3">
<div id="myholder-small"></div>
</div>
</div>

<!--<button onclick="readit()"> Load</button>-->
<button onclick="pngit()"> Save svg </button>
<!--<button onclick="saveit()"> Save</button>-->
<button onclick="clearit()"> New graph</button>
<button onclick="saveitas()"> Save as ...</button>
<!--<button onclick="clearit()"> Clear</button>-->
<button id ="openfile" > Load</button>
<input type="file" id="theFile"/>



<hr>
<div id="myholder"> </div>

<script>

var graph = new joint.dia.Graph;
var paper = new joint.dia.Paper({
    el: $('#myholder'),
    interactive : true,
    width: 1500,
    //width: $(document).width(),
    height: 1000,
    model: graph,
    gridSize: 1
});

var papersmall = new joint.dia.Paper({
    el: $('#myholder-small'),
    width: 340,
    height: 150,
    model: graph,
    gridSize: 1
});
papersmall.scale(.15);
papersmall.$el.css('pointer-events', 'none');

$("#openfile").click(function(){
    $("#theFile").click();
});
document.getElementById('theFile').addEventListener('change', onFileChange);

// Load it automatically
//$(document).ready(function () {
//readit(graph);
//});

graph.on('all', function(eventName, cell) {
    console.log(arguments);
});

</script>
</body>
</html>
